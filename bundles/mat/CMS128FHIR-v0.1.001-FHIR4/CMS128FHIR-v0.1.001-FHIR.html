<!DOCTYPE html>
<html>
<head>
    <style>
      body {
        background-color: #ffffff;;
        margin: 0px;
        padding: 10px;
        height: 100%;
        font-size: 1em;
      }

      p, li {
        font-size: 12px;
        line-height: 1.4em;
        font-family: verdana;
        margin: 0 0 20px 0;
        font-weight: normal;
      }

      td {
        font-size: 12px;
        line-height: 1.4em;
        font-family: verdana;
        font-weight: normal;
        padding: 3px;
        vertical-align: top;
      }

      tr {
        font-size: 12px;
        line-height: 1.4em;
        font-family: verdana;
        font-weight: normal;
        padding: 3px;
        vertical-align: top;
        text-align: left;
      }

      table.colstu td {
        border: 1px grey solid;
        border-spacing: 0;
        padding: 5px;
        border-collapse: collapse;
        background-color: #fff5e6;
      }

      table.colsd td {
        border: 1px grey solid;
        border-spacing: 0;
        padding: 5px;
        border-collapse: collapse;
        background-color: #efefef;
      }

      table.colsn td {
        border: 1px grey solid;
        border-spacing: 0;
        padding: 5px;
        border-collapse: collapse;
        background-color: #e6ffe6;
      }

      table.colse td {
        border: 1px grey solid;
        border-spacing: 0;
        padding: 5px;
        border-collapse: collapse;
        background-color: #e6e6e6;
      }

      table.colsi td {
        border: 1px grey solid;
        border-spacing: 0;
        padding: 5px;
        border-collapse: collapse;
        background-color: #ffffe6;
      }

      table.list td {
        border-top: 1px silver solid;
        border-spacing: 0;
      }

      table.bare td {
        border-spacing: 0;
      }

      ul.dict li {
        font-size: 11px;
        line-height: 1.2em;
        font-family: verdana;
        font-weight: normal;
        padding: 3px;
      }

      table.dict td {
        padding: 3px 7px 2px 7px;
        font-size: 11px;
        line-height: 1.2em;
        font-family: verdana;
        font-weight: normal;
        padding: 3px;
        vertical-align: top;
      }

      table.dict p {
        font-size: 11px;
      }

      table {
        margin-bottom: 10px;
        border-collapse: collapse;
      }

      table.codes td {
        border: 1px solid silver;
        padding: 3px 7px 2px 7px;
        font-size: 12px;
        line-height: 1.4em;
        font-family: verdana;
        font-weight: normal;
        padding: 3px;
        vertical-align: top;
      }

      table.grid {
        margin-bottom: 10px;
        border: 1px black solid;
        margin-right: auto;

      }

      table.grid th {
        border: 1px solid silver;
        padding: 3px 7px 2px 7px;
        font-size: 12px;
        line-height: 1.4em;
        font-family: verdana;
        font-weight: bold;
        padding: 3px;
        vertical-align: top;
      }

      table.grid td {
        border: 1px solid silver;
        padding: 3px 7px 2px 7px;
        font-size: 12px;
        line-height: 1.4em;
        font-family: verdana;
        font-weight: normal;
        padding: 3px;
        vertical-align: top;
      }

      ul {
        margin: 10px 0;
        padding: 0 0 0 25px;
      }

      .dense li {
        margin: 0 0 0 0;
      }

      li {
        margin: 0 0 5px 0;
      }

      h1 {
        font-size: 16px;
        margin: 0 0 4px 0;
        font-family: verdana;
        border-bottom: 1px solid #7e7e7e;
        padding-bottom: 2px;
      }

      h2 {
        font-family: verdana;
        line-height: 1.2em;
        font-size: 14px;
        margin: 0 0 3px 0;
        margin-top: 15px;
        border-bottom: 1px solid #dcdcdc;
        padding-bottom: 2px;
      }

      h3 {
        font-family: verdana;
        line-height: 1.2em;
        font-size: 12px;
        margin: 0 0 3px 0;
        margin-top: 10px;
      }

      h4 {
        font-family: verdana;
        line-height: 1.2em;
        font-size: 11px;
        margin: 0 0 3px 0;
        margin-top: 10px;
      }

      div.sidebar h2 {
        border-bottom: 1px solid #dcdcdc;
        padding-bottom: 2px;
        padding-top: 0px;
        margin-top: 0px;
        font-weight: normal;
        margin-left: 8px;
        margin-bottom: 0px;
        font-size: 12px;
      }

      div.sidebar p {
        padding-bottom: 0px;
        padding-top: 10px;
        font-weight: normal;
        margin-left: 8px;
        font-size: 12px;
        margin-bottom: 8px;
      }

      div.sidebar ul {
        list-style: none;
        padding: 0px;
        margin-left: 6px;
        font-size: 11px;
        line-height: 2.125em;
      }

      div.sidebar li {
        margin: 0px 0px 0px 6px;
        padding: 0px;
        font-size: 11px;
        line-height: 2.125em;
      }

      a {
        color: #428bca;
        text-decoration: none;
      }

      a.xmltag :visited {
        color: Navy;
      }

      a.xmltag :hover {
        color: Blue;
      }

      pre {
        display: block;
        border: 1px solid #cccccc;
        border-radius: 4px;
      }

      pre a {
        color: darkgreen;
        text-decoration: none;
        border: 0;

      }

      /* PrismJS 1.21.0
      https://prismjs.com/download.html#themes=prism&languages=markup+css+clike+javascript+abap+abnf+actionscript+ada+agda+al+antlr4+apacheconf+apl+applescript+aql+arduino+arff+asciidoc+aspnet+asm6502+autohotkey+autoit+bash+basic+batch+bbcode+birb+bison+bnf+brainfuck+brightscript+bro+bsl+c+csharp+cpp+cil+clojure+cmake+coffeescript+concurnas+csp+crystal+css-extras+cypher+d+dart+dax+dhall+diff+django+dns-zone-file+docker+ebnf+editorconfig+eiffel+ejs+elixir+elm+etlua+erb+erlang+excel-formula+fsharp+factor+firestore-security-rules+flow+fortran+ftl+gml+gcode+gdscript+gedcom+gherkin+git+glsl+go+graphql+groovy+haml+handlebars+haskell+haxe+hcl+hlsl+http+hpkp+hsts+ichigojam+icon+ignore+inform7+ini+io+j+java+javadoc+javadoclike+javastacktrace+jolie+jq+jsdoc+js-extras+json+json5+jsonp+jsstacktrace+js-templates+julia+keyman+kotlin+latex+latte+less+lilypond+liquid+lisp+livescript+llvm+lolcode+lua+makefile+markdown+markup-templating+matlab+mel+mizar+mongodb+monkey+moonscript+n1ql+n4js+nand2tetris-hdl+naniscript+nasm+neon+nginx+nim+nix+nsis+objectivec+ocaml+opencl+oz+parigp+parser+pascal+pascaligo+pcaxis+peoplecode+perl+php+phpdoc+php-extras+plsql+powerquery+powershell+processing+prolog+properties+protobuf+pug+puppet+pure+purebasic+purescript+python+q+qml+qore+r+racket+jsx+tsx+reason+regex+renpy+rest+rip+roboconf+robotframework+ruby+rust+sas+sass+scss+scala+scheme+shell-session+smali+smalltalk+smarty+sml+solidity+solution-file+soy+sparql+splunk-spl+sqf+sql+stan+iecst+stylus+swift+t4-templating+t4-cs+t4-vb+tap+tcl+tt2+textile+toml+turtle+twig+typescript+typoscript+unrealscript+vala+vbnet+velocity+verilog+vhdl+vim+visual-basic+warpscript+wasm+wiki+xeora+xml-doc+xojo+xquery+yaml+yang+zig&plugins=keep-markup */
      /**
       * prism.js default theme for JavaScript, CSS and HTML
       * Based on dabblet (http://dabblet.com)
       * @author Lea Verou
       */

      code[class*="language-"],
      pre[class*="language-"] {
        color: black;
        background: none;
        text-shadow: 0 1px white;
        font-family: Consolas, Monaco, 'Andale Mono', 'Ubuntu Mono', monospace;
        font-size: 0.95em;
        text-align: left;
        white-space: pre;
        word-spacing: normal;
        word-break: normal;
        word-wrap: normal;
        line-height: 1.5;

        -moz-tab-size: 4;
        -o-tab-size: 4;
        tab-size: 4;

        -webkit-hyphens: none;
        -moz-hyphens: none;
        -ms-hyphens: none;
        hyphens: none;
      }

      pre[class*="language-"]::-moz-selection, pre[class*="language-"] ::-moz-selection,
      code[class*="language-"]::-moz-selection, code[class*="language-"] ::-moz-selection {
        text-shadow: none;
        background: #b3d4fc;
      }

      pre[class*="language-"]::selection, pre[class*="language-"] ::selection,
      code[class*="language-"]::selection, code[class*="language-"] ::selection {
        text-shadow: none;
        background: #b3d4fc;
      }

      @media print {
        code[class*="language-"],
        pre[class*="language-"] {
          text-shadow: none;
        }
      }

      /* Code blocks */
      pre[class*="language-"] {
        padding: 1em;
        margin: .5em 0;
        overflow: auto;
      }

      :not(pre) > code[class*="language-"],
      pre[class*="language-"] {
        background: #f5f2f0;
      }

      /* Inline code */
      :not(pre) > code[class*="language-"] {
        padding: .1em;
        border-radius: .3em;
        white-space: normal;
      }
    </style>
</head>
<body>
    <div xmlns="http://www.w3.org/1999/xhtml">
    <table class="grid dict">
        
            <tr>
                <th scope="row"><b>Title: </b></th>
                <td style="padding-left: 4px;">Antidepressant Medication ManagementFHIR</td>
            </tr>
        

        

        
            <tr>
                <th scope="row"><b>Id: </b></th>
                <td style="padding-left: 4px;">AntidepressantMedicationManagementFHIR</td>
            </tr>
        

        
            <tr>
                <th scope="row"><b>Version: </b></th>
                <td style="padding-left: 4px;">0.1.001</td>
            </tr>
        

        
            <tr>
                <th scope="row"><b>Url: </b></th>
                <td style="padding-left: 4px;">https://madie.cms.gov/Measure/AntidepressantMedicationManagementFHIR</td>
            </tr>
        

        
            <tr>
                <th scope="row">
                    <b>
                        
                            
                                short-name identifier:
                            
                        
                    </b>
                </th>

                <td style="padding-left: 4px;">
                    
                        <p style="margin-bottom: 5px;">
                            <span>CMS128FHIR</span>
                        </p>
                    
                </td>
            </tr>
        
            <tr>
                <th scope="row">
                    <b>
                        
                            
                                version-independent identifier:
                            
                        
                    </b>
                </th>

                <td style="padding-left: 4px;">
                    
                        <p style="margin-bottom: 5px;">
                            <span>urn:uuid:009a2432-6ee9-48d5-b32a-d727f847f8d2</span>
                        </p>
                    
                </td>
            </tr>
        
            <tr>
                <th scope="row">
                    <b>
                        
                            
                                version-specific identifier:
                            
                        
                    </b>
                </th>

                <td style="padding-left: 4px;">
                    
                        <p style="margin-bottom: 5px;">
                            <span>urn:uuid:5f26d7bc-2d67-41a7-a66b-4a044f7d21e0</span>
                        </p>
                    
                </td>
            </tr>
        
            <tr>
                <th scope="row">
                    <b>
                        
                            
                                publisher (CMS) identifier:
                            
                        
                    </b>
                </th>

                <td style="padding-left: 4px;">
                    
                        <p style="margin-bottom: 5px;">
                            <span>128FHIR</span>
                        </p>
                    
                </td>
            </tr>
        

        
            <tr>
                <th scope="row"><b>Effective Period: </b></th>
                <td style="padding-left: 4px;">2025-01-01
                    ..2025-12-31</td>
            </tr>
        

        
            <tr>
                <th scope="row"><b>Status: </b></th>
                <td style="padding-left: 4px;">draft</td>
            </tr>
        

        

        
            <tr>
                <th scope="row"><b>Date: </b></th>
                <td style="padding-left: 4px;">2024-05-15T16:20:35+00:00</td>
            </tr>
        

        
            <tr>
                <th scope="row"><b>Publisher: </b></th>
                <td style="padding-left: 4px;">National Committee for Quality Assurance</td>
            </tr>
        

        
        <tr>
            <th scope="row"><b>Author: </b></th>
            <td style="padding-left: 4px;">National Committee for Quality Assurance</td>
        </tr>
        

        

        
            <tr>
                <th scope="row"><b>Description: </b></th>
                <td style="padding-left: 4px;">Percentage of patients 18 years of age and older who were treated with antidepressant medication, had a diagnosis of major depression, and who remained on an antidepressant medication treatment. Two rates are reported. 
a. Percentage of patients who remained on an antidepressant medication for at least 84 days (12 weeks). 
b. Percentage of patients who remained on an antidepressant medication for at least 180 days (6 months).</td>
            </tr>
        

        

        

        

        

        

        
            <tr>
                <th scope="row"><b>Purpose: </b></th>
                <td style="padding-left: 4px;">UNKNOWN</td>
            </tr>
        

        
            <tr>
                <th scope="row"><b>Copyright: </b></th>
                <td style="padding-left: 4px;">This Physician Performance Measure (Measure) and related data specifications are owned and were developed by the National Committee for Quality Assurance (NCQA). NCQA is not responsible for any use of the Measure. NCQA makes no representations, warranties, or endorsement about the quality of any organization or physician that uses or reports performance measures and NCQA has no liability to anyone who relies on such measures or specifications. NCQA holds a copyright in the Measure. The Measure can be reproduced and distributed, without modification, for noncommercial purposes (e.g., use by healthcare providers in connection with their practices) without obtaining approval from NCQA. Commercial use is defined as the sale, licensing, or distribution of the Measure for commercial gain, or incorporation of the Measure into a product or service that is sold, licensed or distributed for commercial gain. All commercial uses or requests for modification must be approved by NCQA and are subject to a license at the discretion of NCQA. (C) 2012-2024 National Committee for Quality Assurance. All Rights Reserved.

Limited proprietary coding is contained in the Measure specifications for user convenience. Users of proprietary code sets should obtain all necessary licenses from the owners of the code sets. NCQA disclaims all liability for use or accuracy of any third-party codes contained in the specifications.

CPT(R) codes, descriptions and other data are copyright 2024. American Medical Association. All rights reserved. CPT is a trademark of the American Medical Association. Fee schedules, relative value units, conversion factors and/or related components are not assigned by the AMA, are not part of CPT, and the AMA is not recommending their use. The AMA does not directly or indirectly practice medicine or dispense medical services. The AMA assumes no liability for data contained or not contained herein. Applicable FARS/DFARS restrictions apply to government use.

Some measure specifications contain coding from LOINC(R) (http://loinc.org). The LOINC table, LOINC codes, LOINC panels and form file, LOINC linguistic variants file, LOINC/RSNA Radiology Playbook, and LOINC/IEEE Medical Device Code Mapping Table are copyright 2004-2024 Regenstrief Institute, Inc. and the Logical Observation Identifiers Names and Codes (LOINC) Committee, and are available at no cost under the license at http://loinc.org/terms-of-use.

This material contains SNOMED Clinical Terms(R) (SNOMED CT[R]) copyright 2004-2023 International Health Terminology Standards Development Organisation. 

ICD-10 copyright 2024 World Health Organization. All Rights Reserved.

Some measures use RxNorm, a standardized nomenclature and coding for clinical drugs and drug delivery devices, which is made publicly available courtesy of the U.S. National Library of Medicine (NLM), National Institutes of Health, Department of Health and Human Services. NLM is not responsible for the measures and does not endorse or recommend this or any other product.

“HL7” is the registered trademark of Health Level Seven International.</td>
            </tr>
        

        
            <tr>
                <th scope="row"><b>Disclaimer: </b></th>
                <td style="padding-left: 4px;">The performance Measure is not a clinical guideline and does not establish a standard of medical care, and has not been tested for all potential applications. THE MEASURE AND SPECIFICATIONS ARE PROVIDED &quot;AS IS&quot; WITHOUT WARRANTY OF ANY KIND.
 
Due to technical limitations, registered trademarks are indicated by (R) or [R] and unregistered trademarks are indicated by (TM) or [TM].</td>
            </tr>
        

        

        

        

        

        

        

        

        
        <tr>
            <th scope="row"><b>Rationale: </b></th>
            <td style="padding-left: 4px;">Depression affects over 17 million adults in the U.S. (NIMH, 2021) and is estimated to affect nearly a quarter of adults in their lifetime (Burcusa &amp; Iacono, 2007). Symptoms of depression include disturbances in appetite and sleep, anxiety, decreased concentration, and suicidal ideation (NAMI, 2017; Charbonneau et al., 2005). When left untreated, depression can have a dramatic effect on one’s quality of life, causing constant feelings of hopelessness, loss of interest in daily activities and in some cases suicidal ideation (SAMHSA, 2014).

The American Psychiatric Association (APA) recommends use of antidepressant medication and behavioral therapies, such as psychotherapy, for the treatment and management of depression (APA, 2010). For the past 60 years, antidepressant medication has proven to be effective, especially for patients with more severe symptoms (Fournier et al., 2010). However, studies analyzing adherence to antidepressant medications found that prevalence of nonadherence was high, ranging from 13 percent to 55.7 percent (Sansone, 2012). 

Clinical guidelines for depression emphasize the importance of effective clinical management in increasing patients’ medication compliance, monitoring treatment effectiveness, and identifying and managing side effects. If pharmacological treatment is initiated, appropriate dosing and continuation of therapy through the acute and continuation phases decrease recurrence of symptoms. Thus, the evaluation of the duration of pharmacological treatment serves as an important indicator in understanding patient compliance with establishing and maintaining an effective medication regimen.</td>
        </tr>
        

        
        <tr>
            <th scope="row"><b>Clinical recommendation statement: </b></th>
            <td style="padding-left: 4px;">American Psychological Association (2019): 
- &quot;For initial treatment of adult patients with depression, the panel recommends the following in the context of sharing decision-making with the patient when considering options: 
1. That clinicians offer either psychotherapy or second-generation antidepressant.
2. If considering combined treatment, the panel recommends cognitive-behavioral therapy or interpersonal psychotherapy plus a second-generation antidepressant.”
	
- “For initial treatment of older adult patients with depression, the panel recommends the following in the context of shared decision-making with the patient: 
1. Either group life review treatment or Group Cognitive Behavioral Therapy (either alone or added to usual care) over no treatment 
2. Combined pharmacotherapy and interpersonal psychotherapy (IPT) over IPT alone. Of note, while the study upon which this is based used nortriptyline, the panel recommends a second-generation antidepressant due to the reduced risk of side effects.”

American Psychiatric Association (2010): 
- “An antidepressant medication is recommended as an initial treatment choice for patients with mild to moderate major depressive disorder [I: Recommended with substantial clinical confidence] and definitely should be provided for those with severe major depressive disorder unless electroconvulsive therapy (ECT) is planned [I: Recommended with substantial clinical confidence].” 

- &quot;Patients should be given a realistic notion of what can be expected during the different phases of treatment, including the likely time course of symptom response and the importance of adherence for successful treatment and prophylaxis [I].&quot;

- &quot;During the acute phase of treatment, patients should be carefully and systematically monitored on a regular basis to assess their response to pharmacotherapy, identify the emergence of side effects (e.g., gastrointestinal symptoms, sedation, insomnia, activation, changes in weight, and cardiovascular, neurological, anticholinergic, or sexual side effects), and assess patient safety [I].&quot;

- “During the continuation phase of treatment, the patient should be carefully monitored for signs of possible relapse [I: Recommended with substantial clinical confidence]. Systematic assessment of symptoms, side effects, adherence, and functional status is essential [I: Recommended with substantial clinical confidence], and may be facilitated through the use of clinician- and/or patient-administered rating scales [II: Recommended with moderate clinical confidence]. To reduce the risk of relapse, patients who have been treated successfully with antidepressant medications in the acute phase should continue treatment with these agents for 4–9 months [I: Recommended with substantial clinical confidence].”

Department of Veterans Affairs, and Health Affairs, Department of Defense (2022): 
- “For patients with major depressive disorder (MDD), we suggest using a quantitative measure of depression severity in the initial treatment planning and to monitor treatment progress at regular intervals to guide shared treatment decision making.” [Weak For]
	
- “In patients with MDD who achieve remission with antidepressant medication, we recommend continuation of antidepressants at the therapeutic dose for at least six months to decrease risk of relapse.” [Strong For]

Department of Veterans Affairs, and Health Affairs, Department of Defense (2016):
- ”In patients at high risk for recurrent depressive episodes and who are treated with pharmacotherapy, we recommend offering maintenance pharmacotherapy for at least 12 months and possibly indefinitely.” [Strong For] 
 
- “After initiation of therapy or a change in treatment, we recommend monitoring patients at least monthly until the patient achieves remission. At minimum, assessments should include a measure of symptoms, adherence to medication and psychotherapy, and emergence of adverse effects.” [Strong For] 

- “In patients with MDD who achieve remission with antidepressant medication, we recommend continuation of antidepressants at the therapeutic dose for at least six months to decrease risk of relapse.” [Strong For]</td>
        </tr>
        

        

        
            <tr>
                <th scope="row"><b>Guidance (Usage): </b></th>
                <td style="padding-left: 4px;">To identify new treatment episodes for major depression, there must be a 105-day negative medication history (a period during which the patient was not taking antidepressant medication) prior to the dispensing event associated with the IPSD.

This eCQM is a patient-based measure.

This FHIR-based measure has been derived from the QDM-based measure: CMS128v13.

Please refer to the HL7 QI-Core Implementation Guide (https://hl7.org/fhir/us/qicore/STU4.1.1/) for more information on QI-Core and mapping recommendations from QDM to QI-Core 4.1.1 (https://hl7.org/fhir/us/qicore/STU4.1.1/qdm-to-qicore.html).</td>
            </tr>
        

        
            
                <tr>
                    <th scope="row"><b>Population Criteria: </b></th>
                    <td style="padding-left: 4px;">
                        
                            <table class="grid-dict">
                                
                                    <tr>
                                        <th><b>6621259b0f0a9077c1d5b582</b></th>
                                    </tr>
                                
                                
                                    <tr>
                                        <td>Initial Population:</td>
                                        
                                            <td>Patients 18 years of age and older as of the IPSD who were dispensed antidepressant medications during the Intake Period, and were diagnosed with major depression 60 days prior to, or 60 days after the dispensing event and had a visit 60 days prior to, or 60 days after the dispensing event</td>
                                        
                                    </tr>
                                
                                    <tr>
                                        <td>Denominator:</td>
                                        
                                            <td>Equals Initial Population</td>
                                        
                                    </tr>
                                
                                    <tr>
                                        <td>Denominator Exclusion:</td>
                                        
                                            <td>Exclude patients who are in hospice care for any part of the measurement period.

Patients who were actively on an antidepressant medication in the 105 days prior to the IPSD.</td>
                                        
                                    </tr>
                                
                                    <tr>
                                        <td>Numerator:</td>
                                        
                                            <td>Numerator 1: Patients who have received antidepressant medication for at least 84 days (12 weeks) of continuous treatment beginning on the IPSD through 114 days after the IPSD (115 total days).</td>
                                        
                                    </tr>
                                
                                
                            </table>
                        
                            <table class="grid-dict">
                                
                                    <tr>
                                        <th><b>6621259b0f0a9077c1d5b583</b></th>
                                    </tr>
                                
                                
                                    <tr>
                                        <td>Initial Population:</td>
                                        
                                            <td>None</td>
                                        
                                    </tr>
                                
                                    <tr>
                                        <td>Denominator:</td>
                                        
                                            <td>None</td>
                                        
                                    </tr>
                                
                                    <tr>
                                        <td>Denominator Exclusion:</td>
                                        
                                            <td>Exclude patients who are in hospice care for any part of the measurement period.

Patients who were actively on an antidepressant medication in the 105 days prior to the IPSD.</td>
                                        
                                    </tr>
                                
                                    <tr>
                                        <td>Numerator:</td>
                                        
                                            <td>Numerator 2: Patients who have received antidepressant medications for at least 180 days (6 months) of continuous treatment beginning on the IPSD through 231 days after the IPSD (232 total days).</td>
                                        
                                    </tr>
                                
                                
                            </table>
                        
                    </td>
                </tr>
            
        

        

        

        

        
            <tr>
                <th scope="row"><b>Libraries: </b></th>
                <td style="padding-left: 4px;">
                    <table class="grid-dict">
                        
                            <tr>
                                <td>https://madie.cms.gov/Library/AntidepressantMedicationManagementFHIR</td>
                            </tr>
                        
                    </table>
                </td>
            </tr>
        

        

        
            
                <tr>
                    <th scope="row"><b>Related Artifact Dependencies: </b></th>
                    <td style="padding-left: 4px;">
                        
                            <li>Library/Status|1.8.000</li>
                        
                            <li>Library/CumulativeMedicationDuration|4.1.000</li>
                        
                            <li>Library/FHIRHelpers|4.4.000</li>
                        
                            <li>Library/QICoreCommon|2.1.000</li>
                        
                            <li>Library/Hospice|6.12.000</li>
                        
                            <li>Library/CQMCommon|2.2.000</li>
                        
                            <li>http://snomed.info/sct</li>
                        
                            <li>http://terminology.hl7.org/CodeSystem/observation-category</li>
                        
                            <li>http://loinc.org</li>
                        
                            <li>http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.464.1003.196.12.1213</li>
                        
                            <li>http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.464.1003.105.12.1007</li>
                        
                            <li>http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.464.1003.101.12.1001</li>
                        
                            <li>http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.464.1003.101.12.1025</li>
                        
                            <li>http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.464.1003.101.12.1023</li>
                        
                            <li>http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.464.1003.101.12.1016</li>
                        
                            <li>http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.526.3.1240</li>
                        
                            <li>http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.464.1003.101.12.1012</li>
                        
                            <li>http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.526.3.1492</li>
                        
                            <li>http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.526.3.1496</li>
                        
                            <li>http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.464.1003.101.12.1080</li>
                        
                            <li>http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.464.1003.101.12.1089</li>
                        
                            <li>http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.666.5.307</li>
                        
                            <li>http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.464.1003.1003</li>
                        
                            <li>http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.526.3.1584</li>
                        
                            <li>http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.464.1003.1165</li>
                        
                    </td>
                </tr>
                <tr>
                    <th scope="row"><b>Parameters:</b></th>
                    <td style="padding-left: 4px;">
                        <table class="grid-dict">
                            <tr>
                                <th><b>name</b></th>
                                <th><b>use</b></th>
                                <th><b>min</b></th>
                                <th><b>max</b></th>
                                <th><b>type</b></th>
                            </tr>
                            
                                <tr>
                                    <td>Measurement Period</td>
                                    <td>in</td>
                                    <td>0</td>
                                    <td>1</td>
                                    <td>Period</td>
                                </tr>
                            
                                <tr>
                                    <td>ErrorLevel</td>
                                    <td>in</td>
                                    <td>0</td>
                                    <td>1</td>
                                    <td>string</td>
                                </tr>
                            
                                <tr>
                                    <td>Denominator</td>
                                    <td>out</td>
                                    <td>0</td>
                                    <td>1</td>
                                    <td>boolean</td>
                                </tr>
                            
                                <tr>
                                    <td>Numerator 1</td>
                                    <td>out</td>
                                    <td>0</td>
                                    <td>1</td>
                                    <td>boolean</td>
                                </tr>
                            
                                <tr>
                                    <td>Numerator 2</td>
                                    <td>out</td>
                                    <td>0</td>
                                    <td>1</td>
                                    <td>boolean</td>
                                </tr>
                            
                                <tr>
                                    <td>Initial Population</td>
                                    <td>out</td>
                                    <td>0</td>
                                    <td>1</td>
                                    <td>boolean</td>
                                </tr>
                            
                                <tr>
                                    <td>Denominator Exclusions</td>
                                    <td>out</td>
                                    <td>0</td>
                                    <td>1</td>
                                    <td>boolean</td>
                                </tr>
                            
                        </table>
                    </td>
                </tr>

                <tr>
                    <th scope="row"><b>DataRequirements:</b></th>
                    <td style="padding-left: 4px;">
                        <table class="grid-dict">
                            <tr>
                                <th><b>Type</b></th>
                                <th><b>Elements</b></th>
                                <th><b>Valueset Name</b></th>
                                <th><b>Valueset</b></th>
                            </tr>
                            
                                <tr>
                                    <td>Patient(http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-patient)</td>
                                    <td>
                                        
                                            birthDate
                                        
                                            birthDate.value
                                        
                                    </td>
                                    <td>
                                        
                                    </td>
                                    <td></td>
                                </tr>
                            
                                <tr>
                                    <td>MedicationDispense(http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-medicationdispense)</td>
                                    <td>
                                        
                                            medication
                                        
                                            status
                                        
                                            status.value
                                        
                                            dosageInstruction
                                        
                                            daysSupply
                                        
                                            whenHandedOver
                                        
                                            whenHandedOver.value
                                        
                                            whenPrepared
                                        
                                            whenPrepared.value
                                        
                                            quantity
                                        
                                            quantity.value
                                        
                                    </td>
                                    <td>
                                        
                                            
                                                 Antidepressant Medication
                                            
                                        
                                    </td>
                                    <td>http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.464.1003.196.12.1213</td>
                                </tr>
                            
                                <tr>
                                    <td>Condition(http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-condition)</td>
                                    <td>
                                        
                                            code
                                        
                                    </td>
                                    <td>
                                        
                                            
                                                 Major Depression
                                            
                                        
                                    </td>
                                    <td>http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.464.1003.105.12.1007</td>
                                </tr>
                            
                                <tr>
                                    <td>Condition(http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-condition)</td>
                                    <td>
                                        
                                            code
                                        
                                    </td>
                                    <td>
                                        
                                            
                                                 Hospice Diagnosis
                                            
                                        
                                    </td>
                                    <td>http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.464.1003.1165</td>
                                </tr>
                            
                                <tr>
                                    <td>Encounter(http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter)</td>
                                    <td>
                                        
                                            type
                                        
                                            status
                                        
                                            status.value
                                        
                                            period
                                        
                                    </td>
                                    <td>
                                        
                                            
                                                 Office Visit
                                            
                                        
                                    </td>
                                    <td>http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.464.1003.101.12.1001</td>
                                </tr>
                            
                                <tr>
                                    <td>Encounter(http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter)</td>
                                    <td>
                                        
                                            type
                                        
                                            status
                                        
                                            status.value
                                        
                                            period
                                        
                                    </td>
                                    <td>
                                        
                                            
                                                 Preventive Care Services Established Office Visit, 18 and Up
                                            
                                        
                                    </td>
                                    <td>http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.464.1003.101.12.1025</td>
                                </tr>
                            
                                <tr>
                                    <td>Encounter(http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter)</td>
                                    <td>
                                        
                                            type
                                        
                                            status
                                        
                                            status.value
                                        
                                            period
                                        
                                    </td>
                                    <td>
                                        
                                            
                                                 Preventive Care Services Initial Office Visit, 18 and Up
                                            
                                        
                                    </td>
                                    <td>http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.464.1003.101.12.1023</td>
                                </tr>
                            
                                <tr>
                                    <td>Encounter(http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter)</td>
                                    <td>
                                        
                                            type
                                        
                                            status
                                        
                                            status.value
                                        
                                            period
                                        
                                    </td>
                                    <td>
                                        
                                            
                                                 Home Healthcare Services
                                            
                                        
                                    </td>
                                    <td>http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.464.1003.101.12.1016</td>
                                </tr>
                            
                                <tr>
                                    <td>Encounter(http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter)</td>
                                    <td>
                                        
                                            type
                                        
                                            status
                                        
                                            status.value
                                        
                                            period
                                        
                                    </td>
                                    <td>
                                        
                                            
                                                 Annual Wellness Visit
                                            
                                        
                                    </td>
                                    <td>http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.526.3.1240</td>
                                </tr>
                            
                                <tr>
                                    <td>Encounter(http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter)</td>
                                    <td>
                                        
                                            type
                                        
                                            status
                                        
                                            status.value
                                        
                                            period
                                        
                                    </td>
                                    <td>
                                        
                                            
                                                 Nursing Facility Visit
                                            
                                        
                                    </td>
                                    <td>http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.464.1003.101.12.1012</td>
                                </tr>
                            
                                <tr>
                                    <td>Encounter(http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter)</td>
                                    <td>
                                        
                                            type
                                        
                                            status
                                        
                                            status.value
                                        
                                            period
                                        
                                    </td>
                                    <td>
                                        
                                            
                                                 Psych Visit Diagnostic Evaluation
                                            
                                        
                                    </td>
                                    <td>http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.526.3.1492</td>
                                </tr>
                            
                                <tr>
                                    <td>Encounter(http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter)</td>
                                    <td>
                                        
                                            type
                                        
                                            status
                                        
                                            status.value
                                        
                                            period
                                        
                                    </td>
                                    <td>
                                        
                                            
                                                 Psych Visit Psychotherapy
                                            
                                        
                                    </td>
                                    <td>http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.526.3.1496</td>
                                </tr>
                            
                                <tr>
                                    <td>Encounter(http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter)</td>
                                    <td>
                                        
                                            type
                                        
                                            status
                                        
                                            status.value
                                        
                                            period
                                        
                                    </td>
                                    <td>
                                        
                                            
                                                 Telephone Visits
                                            
                                        
                                    </td>
                                    <td>http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.464.1003.101.12.1080</td>
                                </tr>
                            
                                <tr>
                                    <td>Encounter(http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter)</td>
                                    <td>
                                        
                                            type
                                        
                                            status
                                        
                                            status.value
                                        
                                            period
                                        
                                    </td>
                                    <td>
                                        
                                            
                                                 Virtual Encounter
                                            
                                        
                                    </td>
                                    <td>http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.464.1003.101.12.1089</td>
                                </tr>
                            
                                <tr>
                                    <td>Encounter(http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter)</td>
                                    <td>
                                        
                                            type
                                        
                                            hospitalization
                                        
                                            hospitalization.dischargeDisposition
                                        
                                            period
                                        
                                            status
                                        
                                            status.value
                                        
                                    </td>
                                    <td>
                                        
                                            
                                                 Encounter Inpatient
                                            
                                        
                                    </td>
                                    <td>http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.666.5.307</td>
                                </tr>
                            
                                <tr>
                                    <td>Encounter(http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-encounter)</td>
                                    <td>
                                        
                                            type
                                        
                                            period
                                        
                                            status
                                        
                                            status.value
                                        
                                    </td>
                                    <td>
                                        
                                            
                                                 Hospice Encounter
                                            
                                        
                                    </td>
                                    <td>http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.464.1003.1003</td>
                                </tr>
                            
                                <tr>
                                    <td>Observation(http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-observation)</td>
                                    <td>
                                        
                                            code
                                        
                                            value
                                        
                                            effective
                                        
                                            status
                                        
                                            status.value
                                        
                                            category
                                        
                                    </td>
                                    <td>
                                        
                                    </td>
                                    <td></td>
                                </tr>
                            
                                <tr>
                                    <td>ServiceRequest(http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-servicerequest)</td>
                                    <td>
                                        
                                            code
                                        
                                            authoredOn
                                        
                                            authoredOn.value
                                        
                                            status
                                        
                                            status.value
                                        
                                            intent
                                        
                                            intent.value
                                        
                                    </td>
                                    <td>
                                        
                                            
                                                 Hospice Care Ambulatory
                                            
                                        
                                    </td>
                                    <td>http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.526.3.1584</td>
                                </tr>
                            
                                <tr>
                                    <td>Procedure(http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-procedure)</td>
                                    <td>
                                        
                                            code
                                        
                                            performed
                                        
                                            status
                                        
                                            status.value
                                        
                                    </td>
                                    <td>
                                        
                                            
                                                 Hospice Care Ambulatory
                                            
                                        
                                    </td>
                                    <td>http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.526.3.1584</td>
                                </tr>
                            
                                <tr>
                                    <td>MedicationRequest(http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-medicationrequest)</td>
                                    <td>
                                        
                                            medication
                                        
                                            status
                                        
                                            status.value
                                        
                                            intent
                                        
                                            intent.value
                                        
                                            dosageInstruction
                                        
                                            dispenseRequest
                                        
                                            dispenseRequest.expectedSupplyDuration
                                        
                                            dispenseRequest.quantity
                                        
                                            dispenseRequest.numberOfRepeatsAllowed
                                        
                                            dispenseRequest.numberOfRepeatsAllowed.value
                                        
                                            authoredOn
                                        
                                            authoredOn.value
                                        
                                            dispenseRequest.validityPeriod
                                        
                                    </td>
                                    <td>
                                        
                                            
                                                 Antidepressant Medication
                                            
                                        
                                    </td>
                                    <td>http://cts.nlm.nih.gov/fhir/ValueSet/2.16.840.1.113883.3.464.1003.196.12.1213</td>
                                </tr>
                            
                                <tr>
                                    <td>MedicationRequest(http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-medicationrequest)</td>
                                    <td>
                                        
                                            medication.reference
                                        
                                            status
                                        
                                            status.value
                                        
                                            intent
                                        
                                            intent.value
                                        
                                            dosageInstruction
                                        
                                            dispenseRequest
                                        
                                            dispenseRequest.expectedSupplyDuration
                                        
                                            dispenseRequest.quantity
                                        
                                            dispenseRequest.numberOfRepeatsAllowed
                                        
                                            dispenseRequest.numberOfRepeatsAllowed.value
                                        
                                            authoredOn
                                        
                                            authoredOn.value
                                        
                                            dispenseRequest.validityPeriod
                                        
                                    </td>
                                    <td>
                                        
                                    </td>
                                    <td></td>
                                </tr>
                            
                                <tr>
                                    <td>Medication(http://hl7.org/fhir/us/qicore/StructureDefinition/qicore-medication)</td>
                                    <td>
                                        
                                            id
                                        
                                    </td>
                                    <td>
                                        
                                    </td>
                                    <td></td>
                                </tr>
                            
                        </table>
                    </td>
                </tr>

                
                    <tr>
                        <th scope="row"><b>Direct Reference Codes:</b></th>
                        <td style="padding-left: 4px;">
                            <table class="grid-dict">
                                <tr>
                                    <th><b>display</b></th>
                                    <th><b>code</b></th>
                                    <th><b>system</b></th>
                                </tr>
                                
                                    <tr>
                                        <td>Discharge to home for hospice care (procedure)</td>
                                        <td>428361000124107</td>
                                        <td>http://snomed.info/sct</td>
                                    </tr>
                                
                                    <tr>
                                        <td>Discharge to healthcare facility for hospice care (procedure)</td>
                                        <td>428371000124100</td>
                                        <td>http://snomed.info/sct</td>
                                    </tr>
                                
                                    <tr>
                                        <td>survey</td>
                                        <td>survey</td>
                                        <td>http://terminology.hl7.org/CodeSystem/observation-category</td>
                                    </tr>
                                
                                    <tr>
                                        <td>Hospice care [Minimum Data Set]</td>
                                        <td>45755-6</td>
                                        <td>http://loinc.org</td>
                                    </tr>
                                
                                    <tr>
                                        <td>Yes (qualifier value)</td>
                                        <td>373066001</td>
                                        <td>http://snomed.info/sct</td>
                                    </tr>
                                
                            </table>
                        </td>
                    </tr>
                

                
                <tr>
                    <th scope="row"><b>Logic Definitions:</b></th>
                    <td style="padding-left: 4px;">
                        
                        <table class="grid-dict">
                            <tr>
                                <th><b>Group</b></th>
                                <th><b>Scoring</b></th>
                                <th><b>Population Criteria</b></th>
                                <th><b>Expression</b></th>
                            </tr>
                            <tr>
                                
                                <td> 6621259b0f0a9077c1d5b582 </td>
                                <td>
                                    
                                        <b>Group scoring:</b>
                                        
                                            <span>  proportion </span>
                                        
                                    

                                    

                                    

                                    

                                    

                                    

                                    
                                    <tr>
                                        <th scope="row"><b>Rate Aggregation: </b></th>
                                        <td colspan="3" style="padding-left: 4px;">None</td>
                                    </tr>
                                    

                                    
                                        <tr>
                                            <th scope="row"><b>Improvement Notation: </b></th>
                                            <td style="padding-left: 4px;">
                                            
                                                
                                                
                                            
                                            </td>
                                        </tr>
                                    

                                </td>
                                
                                <tr>
                                    <td/>
                                    <td/>
                                    <td>Initial Population</td>
                                    <td>
                                        
                                            <pre><code class="language-cql">define &quot;Initial Population&quot;:
  AgeInYearsAt(date from &quot;IPSD&quot;) &gt;= 18
    and &quot;Has IPSD and Major Depression Diagnosis&quot;
    and exists &quot;Qualifying Encounters&quot;</code></pre>
                                        
                                    </td>
                                </tr>
                                
                                <tr>
                                    <td/>
                                    <td/>
                                    <td>Denominator</td>
                                    <td>
                                        
                                            <pre><code class="language-cql">define &quot;Denominator&quot;:
  &quot;Initial Population&quot;</code></pre>
                                        
                                    </td>
                                </tr>
                                
                                <tr>
                                    <td/>
                                    <td/>
                                    <td>Denominator Exclusion</td>
                                    <td>
                                        
                                            <pre><code class="language-cql">define &quot;Denominator Exclusions&quot;:
  Hospice.&quot;Has Hospice Services&quot;
    or exists ( ( ( ( [MedicationRequest: &quot;Antidepressant Medication&quot;] ).isMedicationActive ( ) ) ActiveAntidepressant
          where &quot;IPSD&quot; is not null
            and CQMCommon.ToDateInterval ( ActiveAntidepressant.medicationRequestPeriod ( ) ) overlaps Interval[&quot;IPSD&quot; - 105 days, &quot;IPSD&quot; )
      )
    )</code></pre>
                                        
                                    </td>
                                </tr>
                                
                                <tr>
                                    <td/>
                                    <td/>
                                    <td>Numerator</td>
                                    <td>
                                        
                                            <pre><code class="language-cql">define &quot;Numerator 1&quot;:
  &quot;Cumulative Medication Duration Greater Than or Equal to 84 Days&quot;</code></pre>
                                        
                                    </td>
                                </tr>
                                
                                
                            
                                <td> 6621259b0f0a9077c1d5b583 </td>
                                <td>
                                    
                                        <b>Group scoring:</b>
                                        
                                            <span>  proportion </span>
                                        
                                    

                                    

                                    

                                    

                                    

                                    

                                    
                                    <tr>
                                        <th scope="row"><b>Rate Aggregation: </b></th>
                                        <td colspan="3" style="padding-left: 4px;">None</td>
                                    </tr>
                                    

                                    
                                        <tr>
                                            <th scope="row"><b>Improvement Notation: </b></th>
                                            <td style="padding-left: 4px;">
                                            
                                                
                                                
                                            
                                            </td>
                                        </tr>
                                    

                                </td>
                                
                                <tr>
                                    <td/>
                                    <td/>
                                    <td>Initial Population</td>
                                    <td>
                                        
                                            <pre><code class="language-cql">define &quot;Initial Population&quot;:
  AgeInYearsAt(date from &quot;IPSD&quot;) &gt;= 18
    and &quot;Has IPSD and Major Depression Diagnosis&quot;
    and exists &quot;Qualifying Encounters&quot;</code></pre>
                                        
                                    </td>
                                </tr>
                                
                                <tr>
                                    <td/>
                                    <td/>
                                    <td>Denominator</td>
                                    <td>
                                        
                                            <pre><code class="language-cql">define &quot;Denominator&quot;:
  &quot;Initial Population&quot;</code></pre>
                                        
                                    </td>
                                </tr>
                                
                                <tr>
                                    <td/>
                                    <td/>
                                    <td>Denominator Exclusion</td>
                                    <td>
                                        
                                            <pre><code class="language-cql">define &quot;Denominator Exclusions&quot;:
  Hospice.&quot;Has Hospice Services&quot;
    or exists ( ( ( ( [MedicationRequest: &quot;Antidepressant Medication&quot;] ).isMedicationActive ( ) ) ActiveAntidepressant
          where &quot;IPSD&quot; is not null
            and CQMCommon.ToDateInterval ( ActiveAntidepressant.medicationRequestPeriod ( ) ) overlaps Interval[&quot;IPSD&quot; - 105 days, &quot;IPSD&quot; )
      )
    )</code></pre>
                                        
                                    </td>
                                </tr>
                                
                                <tr>
                                    <td/>
                                    <td/>
                                    <td>Numerator</td>
                                    <td>
                                        
                                            <pre><code class="language-cql">define &quot;Numerator 2&quot;:
  &quot;Cumulative Medication Duration Greater Than or Equal to 180 Days&quot;</code></pre>
                                        
                                    </td>
                                </tr>
                                
                                
                            
                            </tr>
                        </table>
                

                <table class="grid-dict">
                    
                        <tr>
                            <th><b>Library Name</b></th>
                            <th><b>Name</b></th>
                        </tr>
                        <tr>
                            
                                <td>AntidepressantMedicationManagementFHIR</td>
                            
                            
                                <td>May 1 of the Year Prior to the Measurement Period</td>
                            
                        </tr>
                        <tr>
                            
                                <td></td>
                                <td>
                                    <pre class="highlight language-cql"><code class="language-cql">define &quot;May 1 of the Year Prior to the Measurement Period&quot;:
  DateTime((year from start of &quot;Measurement Period&quot; - 1), 5, 1, 0, 0, 0, 0, 0)</code></pre>
                                </td>
                            
                        </tr>
                    
                        <tr>
                            <th><b>Library Name</b></th>
                            <th><b>Name</b></th>
                        </tr>
                        <tr>
                            
                                <td>AntidepressantMedicationManagementFHIR</td>
                            
                            
                                <td>April 30 of the Measurement Period</td>
                            
                        </tr>
                        <tr>
                            
                                <td></td>
                                <td>
                                    <pre class="highlight language-cql"><code class="language-cql">define &quot;April 30 of the Measurement Period&quot;:
  DateTime((year from start of &quot;Measurement Period&quot;), 4, 30, 23, 59, 59, 0, 0)</code></pre>
                                </td>
                            
                        </tr>
                    
                        <tr>
                            <th><b>Library Name</b></th>
                            <th><b>Name</b></th>
                        </tr>
                        <tr>
                            
                                <td>AntidepressantMedicationManagementFHIR</td>
                            
                            
                                <td>Intake Period</td>
                            
                        </tr>
                        <tr>
                            
                                <td></td>
                                <td>
                                    <pre class="highlight language-cql"><code class="language-cql">define &quot;Intake Period&quot;:
  Interval[&quot;May 1 of the Year Prior to the Measurement Period&quot;, &quot;April 30 of the Measurement Period&quot;]</code></pre>
                                </td>
                            
                        </tr>
                    
                        <tr>
                            <th><b>Library Name</b></th>
                            <th><b>Name</b></th>
                        </tr>
                        <tr>
                            
                                <td>AntidepressantMedicationManagementFHIR</td>
                            
                            
                                <td>Earliest Antidepressant Dispensed During Intake Period</td>
                            
                        </tr>
                        <tr>
                            
                                <td></td>
                                <td>
                                    <pre class="highlight language-cql"><code class="language-cql">define &quot;Earliest Antidepressant Dispensed During Intake Period&quot;:
  First((([MedicationDispense: &quot;Antidepressant Medication&quot;]).isMedicationDispensed()) Antidepressant
      where start of Antidepressant.medicationDispensePeriod() in day of &quot;Intake Period&quot;
      return {
        AntidepressantDate: date from start of Antidepressant.medicationDispensePeriod()
      }
      sort by AntidepressantDate
  ).AntidepressantDate</code></pre>
                                </td>
                            
                        </tr>
                    
                        <tr>
                            <th><b>Library Name</b></th>
                            <th><b>Name</b></th>
                        </tr>
                        <tr>
                            
                                <td>AntidepressantMedicationManagementFHIR</td>
                            
                            
                                <td>IPSD</td>
                            
                        </tr>
                        <tr>
                            
                                <td></td>
                                <td>
                                    <pre class="highlight language-cql"><code class="language-cql">define &quot;IPSD&quot;:
  &quot;Earliest Antidepressant Dispensed During Intake Period&quot;</code></pre>
                                </td>
                            
                        </tr>
                    
                        <tr>
                            <th><b>Library Name</b></th>
                            <th><b>Name</b></th>
                        </tr>
                        <tr>
                            
                                <td>AntidepressantMedicationManagementFHIR</td>
                            
                            
                                <td>Has IPSD and Major Depression Diagnosis</td>
                            
                        </tr>
                        <tr>
                            
                                <td></td>
                                <td>
                                    <pre class="highlight language-cql"><code class="language-cql">define &quot;Has IPSD and Major Depression Diagnosis&quot;:
  exists ( [Condition: &quot;Major Depression&quot;] MajorDepression
      where &quot;IPSD&quot; is not null
        and date from start of MajorDepression.prevalenceInterval ( ) within 60 days of &quot;IPSD&quot;
  )</code></pre>
                                </td>
                            
                        </tr>
                    
                        <tr>
                            <th><b>Library Name</b></th>
                            <th><b>Name</b></th>
                        </tr>
                        <tr>
                            
                                <td>AntidepressantMedicationManagementFHIR</td>
                            
                            
                                <td>Qualifying Encounters</td>
                            
                        </tr>
                        <tr>
                            
                                <td></td>
                                <td>
                                    <pre class="highlight language-cql"><code class="language-cql">define &quot;Qualifying Encounters&quot;:
  ( ( [Encounter: &quot;Office Visit&quot;]
      union [Encounter: &quot;Preventive Care Services Established Office Visit, 18 and Up&quot;]
      union [Encounter: &quot;Preventive Care Services Initial Office Visit, 18 and Up&quot;]
      union [Encounter: &quot;Home Healthcare Services&quot;]
      union [Encounter: &quot;Annual Wellness Visit&quot;]
      union [Encounter: &quot;Nursing Facility Visit&quot;]
      union [Encounter: &quot;Psych Visit Diagnostic Evaluation&quot;]
      union [Encounter: &quot;Psych Visit Psychotherapy&quot;]
      union [Encounter: &quot;Telephone Visits&quot;]
      union [Encounter: &quot;Virtual Encounter&quot;]
  ).isEncounterPerformed ( ) ) ValidEncounter
    where date from start of ValidEncounter.period.toInterval ( ) within 60 days of &quot;IPSD&quot;</code></pre>
                                </td>
                            
                        </tr>
                    
                        <tr>
                            <th><b>Library Name</b></th>
                            <th><b>Name</b></th>
                        </tr>
                        <tr>
                            
                                <td>AntidepressantMedicationManagementFHIR</td>
                            
                            
                                <td>Initial Population</td>
                            
                        </tr>
                        <tr>
                            
                                <td></td>
                                <td>
                                    <pre class="highlight language-cql"><code class="language-cql">define &quot;Initial Population&quot;:
  AgeInYearsAt(date from &quot;IPSD&quot;) &gt;= 18
    and &quot;Has IPSD and Major Depression Diagnosis&quot;
    and exists &quot;Qualifying Encounters&quot;</code></pre>
                                </td>
                            
                        </tr>
                    
                        <tr>
                            <th><b>Library Name</b></th>
                            <th><b>Name</b></th>
                        </tr>
                        <tr>
                            
                                <td>AntidepressantMedicationManagementFHIR</td>
                            
                            
                                <td>Denominator</td>
                            
                        </tr>
                        <tr>
                            
                                <td></td>
                                <td>
                                    <pre class="highlight language-cql"><code class="language-cql">define &quot;Denominator&quot;:
  &quot;Initial Population&quot;</code></pre>
                                </td>
                            
                        </tr>
                    
                        <tr>
                            <th><b>Library Name</b></th>
                            <th><b>Name</b></th>
                        </tr>
                        <tr>
                            
                                <td>AntidepressantMedicationManagementFHIR</td>
                            
                            
                                <td>Antidepressant Medication Period Between IPSD and 114 Days After IPSD</td>
                            
                        </tr>
                        <tr>
                            
                                <td></td>
                                <td>
                                    <pre class="highlight language-cql"><code class="language-cql">define &quot;Antidepressant Medication Period Between IPSD and 114 Days After IPSD&quot;:
  ( ( [MedicationDispense: &quot;Antidepressant Medication&quot;] ).isMedicationDispensed ( ) ) Antidepressant
    let MedicationPeriod: Antidepressant.medicationDispensePeriod ( )
    return MedicationPeriod
      intersect Interval[&quot;IPSD&quot;, &quot;IPSD&quot; + 114 days]</code></pre>
                                </td>
                            
                        </tr>
                    
                        <tr>
                            <th><b>Library Name</b></th>
                            <th><b>Name</b></th>
                        </tr>
                        <tr>
                            
                                <td>AntidepressantMedicationManagementFHIR</td>
                            
                            
                                <td>Cumulative Medication Duration Greater Than or Equal to 84 Days</td>
                            
                        </tr>
                        <tr>
                            
                                <td></td>
                                <td>
                                    <pre class="highlight language-cql"><code class="language-cql">define &quot;Cumulative Medication Duration Greater Than or Equal to 84 Days&quot;:
  ( &quot;Antidepressant Medication Period Between IPSD and 114 Days After IPSD&quot;.cumulativeDuration ( ) ) &gt;= 84</code></pre>
                                </td>
                            
                        </tr>
                    
                        <tr>
                            <th><b>Library Name</b></th>
                            <th><b>Name</b></th>
                        </tr>
                        <tr>
                            
                                <td>AntidepressantMedicationManagementFHIR</td>
                            
                            
                                <td>Numerator 1</td>
                            
                        </tr>
                        <tr>
                            
                                <td></td>
                                <td>
                                    <pre class="highlight language-cql"><code class="language-cql">define &quot;Numerator 1&quot;:
  &quot;Cumulative Medication Duration Greater Than or Equal to 84 Days&quot;</code></pre>
                                </td>
                            
                        </tr>
                    
                        <tr>
                            <th><b>Library Name</b></th>
                            <th><b>Name</b></th>
                        </tr>
                        <tr>
                            
                                <td>AntidepressantMedicationManagementFHIR</td>
                            
                            
                                <td>Antidepressant Medication Period Between IPSD and 231 Days After IPSD</td>
                            
                        </tr>
                        <tr>
                            
                                <td></td>
                                <td>
                                    <pre class="highlight language-cql"><code class="language-cql">define &quot;Antidepressant Medication Period Between IPSD and 231 Days After IPSD&quot;:
  ( ( [MedicationDispense: &quot;Antidepressant Medication&quot;] ).isMedicationDispensed ( ) ) Antidepressant
    let MedicationPeriod: Antidepressant.medicationDispensePeriod ( )
    return MedicationPeriod
      intersect Interval[&quot;IPSD&quot;, &quot;IPSD&quot; + 231 days]</code></pre>
                                </td>
                            
                        </tr>
                    
                        <tr>
                            <th><b>Library Name</b></th>
                            <th><b>Name</b></th>
                        </tr>
                        <tr>
                            
                                <td>AntidepressantMedicationManagementFHIR</td>
                            
                            
                                <td>Cumulative Medication Duration Greater Than or Equal to 180 Days</td>
                            
                        </tr>
                        <tr>
                            
                                <td></td>
                                <td>
                                    <pre class="highlight language-cql"><code class="language-cql">define &quot;Cumulative Medication Duration Greater Than or Equal to 180 Days&quot;:
  ( &quot;Antidepressant Medication Period Between IPSD and 231 Days After IPSD&quot;.cumulativeDuration ( ) ) &gt;= 180</code></pre>
                                </td>
                            
                        </tr>
                    
                        <tr>
                            <th><b>Library Name</b></th>
                            <th><b>Name</b></th>
                        </tr>
                        <tr>
                            
                                <td>AntidepressantMedicationManagementFHIR</td>
                            
                            
                                <td>Numerator 2</td>
                            
                        </tr>
                        <tr>
                            
                                <td></td>
                                <td>
                                    <pre class="highlight language-cql"><code class="language-cql">define &quot;Numerator 2&quot;:
  &quot;Cumulative Medication Duration Greater Than or Equal to 180 Days&quot;</code></pre>
                                </td>
                            
                        </tr>
                    
                        <tr>
                            <th><b>Library Name</b></th>
                            <th><b>Name</b></th>
                        </tr>
                        <tr>
                            
                                <td>Hospice</td>
                            
                            
                                <td>Has Hospice Services</td>
                            
                        </tr>
                        <tr>
                            
                                <td></td>
                                <td>
                                    <pre class="highlight language-cql"><code class="language-cql">define &quot;Has Hospice Services&quot;:
  exists ((([Encounter: &quot;Encounter Inpatient&quot;]).isEncounterPerformed()) InpatientEncounter
      where (InpatientEncounter.hospitalization.dischargeDisposition ~ &quot;Discharge to home for hospice care (procedure)&quot;
          or InpatientEncounter.hospitalization.dischargeDisposition ~ &quot;Discharge to healthcare facility for hospice care (procedure)&quot;
      )
        and InpatientEncounter.period.toInterval() ends during day of &quot;Measurement Period&quot;
  )
    or exists ((([Encounter: &quot;Hospice Encounter&quot;]).isEncounterPerformed()) HospiceEncounter
        where HospiceEncounter.period.toInterval() overlaps day of &quot;Measurement Period&quot;
    )
    or exists ((([Observation: &quot;Hospice care [Minimum Data Set]&quot;]).isAssessmentPerformed()) HospiceAssessment
        where HospiceAssessment.value ~ &quot;Yes (qualifier value)&quot;
          and HospiceAssessment.effective.toInterval() overlaps day of &quot;Measurement Period&quot;
    )
    or exists ((([ServiceRequest: &quot;Hospice Care Ambulatory&quot;]).isInterventionOrder()) HospiceOrder
        where HospiceOrder.authoredOn.toInterval() during day of &quot;Measurement Period&quot;
        // and HospiceOrder.doNotPerform is not true
        // https://oncprojectracking.healthit.gov/support/browse/CQLIT-447
    )
    or exists ((([Procedure: &quot;Hospice Care Ambulatory&quot;]).isInterventionPerformed()) HospicePerformed
        where HospicePerformed.performed.toInterval() overlaps day of &quot;Measurement Period&quot;
    )
    or exists (([Condition: &quot;Hospice Diagnosis&quot;]) HospiceCareDiagnosis
        where HospiceCareDiagnosis.prevalenceInterval() overlaps day of &quot;Measurement Period&quot;
    )</code></pre>
                                </td>
                            
                        </tr>
                    
                        <tr>
                            <th><b>Library Name</b></th>
                            <th><b>Name</b></th>
                        </tr>
                        <tr>
                            
                                <td>AntidepressantMedicationManagementFHIR</td>
                            
                            
                                <td>Denominator Exclusions</td>
                            
                        </tr>
                        <tr>
                            
                                <td></td>
                                <td>
                                    <pre class="highlight language-cql"><code class="language-cql">define &quot;Denominator Exclusions&quot;:
  Hospice.&quot;Has Hospice Services&quot;
    or exists ( ( ( ( [MedicationRequest: &quot;Antidepressant Medication&quot;] ).isMedicationActive ( ) ) ActiveAntidepressant
          where &quot;IPSD&quot; is not null
            and CQMCommon.ToDateInterval ( ActiveAntidepressant.medicationRequestPeriod ( ) ) overlaps Interval[&quot;IPSD&quot; - 105 days, &quot;IPSD&quot; )
      )
    )</code></pre>
                                </td>
                            
                        </tr>
                    
                        <tr>
                            <th><b>Library Name</b></th>
                            <th><b>Name</b></th>
                        </tr>
                        <tr>
                            
                                <td>Status</td>
                            
                            
                                <td>isMedicationDispensed</td>
                            
                        </tr>
                        <tr>
                            
                                <td></td>
                                <td>
                                    <pre class="highlight language-cql"><code class="language-cql">//Medication, Dispensed
define fluent function isMedicationDispensed(Med List&lt;MedicationDispense&gt;):
  Med M
    where M.status in { 'completed', 'in-progress', 'on-hold' }</code></pre>
                                </td>
                            
                        </tr>
                    
                        <tr>
                            <th><b>Library Name</b></th>
                            <th><b>Name</b></th>
                        </tr>
                        <tr>
                            
                                <td>CumulativeMedicationDuration</td>
                            
                            
                                <td>medicationDispensePeriod</td>
                            
                        </tr>
                        <tr>
                            
                                <td></td>
                                <td>
                                    <pre class="highlight language-cql"><code class="language-cql">/*
Calculates Medication Period for a given MedicationDispense
MedicationDispense instances provided to this function are expected
to conform to the [TODO: MMEMedicationDispense](http://build.fhir.org/ig/cqframework/opioid-mme-r4/StructureDefinition-mmemedicationdispense.html)
profile, which expects:
* 1 and only 1 dosageInstruction, multiple dosageInstruction elements will result in an error
* 1 and only 1 doseAndRate, multiple doseAndRate elements will result in an error
* 1 timing with 1 repeat, missing timing or repeat elements will result in a null
* frequency, frequencyMax, defaulting to 1
* period, periodUnit, defaulting to 1 'd'
* timeOfDay
* doseQuantity or doseRange, missing doseQuantity and doseRange will result in a null
* whenHandedOver or whenPrepared, if missing both whenHandedOver and whenPrepared will result in a null
Note that MedicationDispense status is not considered by this calculation, as the
list of MedicationDispense instances provided to this function should already have
considered appropriate statuses, depending on the use case, typically `completed`,
especially since whenHandedOver would be expected to be present for a completed
MedicationDispense.
Note also that the dosage information recorded in a dispense is expected to be a copy of the
dispense information from the related medication request. As such, the boundsPeriod would be expected
to cover the entire range, and should _not_ be used for timing of the event.
There is also active discussion in the Pharmacy WG about what date should be used if whenPrepared/whenHandedOver is not present.
This may take the form of an &quot;original creation date&quot;, but may also be a &quot;status change date&quot; for dispense events that are updating
status of an existing dispense. That discussion is ongoing, so until that is resolved, this logic will return
null if whenPrepared/whenHandedOver are not available.
*/
define fluent function medicationDispensePeriod(Dispense &quot;MedicationDispense&quot;):
  Dispense D
    let
      dosage: singleton from D.dosageInstruction,
      doseAndRate: singleton from dosage.doseAndRate,
      timing: dosage.timing,
      frequency: Coalesce(timing.repeat.frequencyMax, timing.repeat.frequency),
      period: Quantity(timing.repeat.period, timing.repeat.periodUnit),
      doseRange: doseAndRate.dose,
      doseQuantity: doseAndRate.dose,
      dose: Coalesce(end of doseRange, doseQuantity),
      daysSupply: (convert D.daysSupply to days).value,
      dosesPerDay: Coalesce(ToDaily(frequency, period), Count(timing.repeat.timeOfDay), 1.0),
      startDate:
        Coalesce(
          date from D.whenHandedOver,
          date from D.whenPrepared
        ),
      totalDaysSupplied: Coalesce(daysSupply, D.quantity.value / (dose.value * dosesPerDay))
    return
      if startDate is not null and totalDaysSupplied is not null then
        Interval[startDate, startDate + Quantity(totalDaysSupplied - 1, 'day')]
      else
        null</code></pre>
                                </td>
                            
                        </tr>
                    
                        <tr>
                            <th><b>Library Name</b></th>
                            <th><b>Name</b></th>
                        </tr>
                        <tr>
                            
                                <td>CumulativeMedicationDuration</td>
                            
                            
                                <td>Quantity</td>
                            
                        </tr>
                        <tr>
                            
                                <td></td>
                                <td>
                                    <pre class="highlight language-cql"><code class="language-cql">/**********************************************************************/
/* Functions in this region are copied from opioid-mme-r4             */
/**********************************************************************/

define function Quantity(value Decimal, unit String):
  if value is not null then
    System.Quantity { value: value, unit: unit }
  else
    null</code></pre>
                                </td>
                            
                        </tr>
                    
                        <tr>
                            <th><b>Library Name</b></th>
                            <th><b>Name</b></th>
                        </tr>
                        <tr>
                            
                                <td>CumulativeMedicationDuration</td>
                            
                            
                                <td>ToDaily</td>
                            
                        </tr>
                        <tr>
                            
                                <td></td>
                                <td>
                                    <pre class="highlight language-cql"><code class="language-cql">/*
 Goal is to get to number of days
 Two broad approaches to the calculation:
  1) Based on supply and frequency, calculate the number of expected days the medication will cover/has covered
  2) Based on relevant period, determine a covered interval and calculate the length of that interval in days
This topic covers several use cases and illustrates how to calculate Cumulative
Medication Duration for each type of medication resource using the supply and
frequency approach.
*/

/*
  For the first approach, we need to get from frequency to a frequency/day
  So we define ToDaily
*/

/*
  Calculates daily frequency given frequency within a period
*/
define function ToDaily(frequency System.Integer, period System.Quantity):
  case period.unit
    when 'h' then frequency * (24.0 / period.value)
    when 'min' then frequency * (24.0 / period.value) * 60
    when 's' then frequency * (24.0 / period.value) * 60 * 60
    when 'd' then frequency * (24.0 / period.value) / 24
    when 'wk' then frequency * (24.0 / period.value) / (24 * 7)
    when 'mo' then frequency * (24.0 / period.value) / (24 * 30) /* assuming 30 days in month */
    when 'a' then frequency * (24.0 / period.value) / (24 * 365) /* assuming 365 days in year */
    when 'hour' then frequency * (24.0 / period.value)
    when 'minute' then frequency * (24.0 / period.value) * 60
    when 'second' then frequency * (24.0 / period.value) * 60 * 60
    when 'day' then frequency * (24.0 / period.value) / 24
    when 'week' then frequency * (24.0 / period.value) / (24 * 7)
    when 'month' then frequency * (24.0 / period.value) / (24 * 30) /* assuming 30 days in month */
    when 'year' then frequency * (24.0 / period.value) / (24 * 365) /* assuming 365 days in year */
    when 'hours' then frequency * (24.0 / period.value)
    when 'minutes' then frequency * (24.0 / period.value) * 60
    when 'seconds' then frequency * (24.0 / period.value) * 60 * 60
    when 'days' then frequency * (24.0 / period.value) / 24
    when 'weeks' then frequency * (24.0 / period.value) / (24 * 7)
    when 'months' then frequency * (24.0 / period.value) / (24 * 30) /* assuming 30 days in month */
    when 'years' then frequency * (24.0 / period.value) / (24 * 365) /* assuming 365 days in year */
    else Message(null, true, 'CMDLogic.ToDaily.UnknownUnit', ErrorLevel, 'Unknown unit ' &amp; period.unit)
  end</code></pre>
                                </td>
                            
                        </tr>
                    
                        <tr>
                            <th><b>Library Name</b></th>
                            <th><b>Name</b></th>
                        </tr>
                        <tr>
                            
                                <td>QICoreCommon</td>
                            
                            
                                <td>prevalenceInterval</td>
                            
                        </tr>
                        <tr>
                            
                                <td></td>
                                <td>
                                    <pre class="highlight language-cql"><code class="language-cql">/*
@description: Returns an interval representing the normalized prevalence period of a given Condition.
@comment: Uses the ToInterval and ToAbatementInterval functions to determine the widest potential interval from
onset to abatement as specified in the given Condition. If the condition is active, or has an abatement date the resulting 
interval will have a closed ending boundary. Otherwise, the resulting interval will have an open ending boundary.
*/
define fluent function prevalenceInterval(condition Condition):
if condition.clinicalStatus ~ &quot;active&quot;
  or condition.clinicalStatus ~ &quot;recurrence&quot;
  or condition.clinicalStatus ~ &quot;relapse&quot; then
  Interval[start of condition.onset.toInterval(), end of condition.abatementInterval()]
else
    (end of condition.abatementInterval()) abatementDate
    return if abatementDate is null then
      Interval[start of condition.onset.toInterval(), abatementDate)
    else
      Interval[start of condition.onset.toInterval(), abatementDate]</code></pre>
                                </td>
                            
                        </tr>
                    
                        <tr>
                            <th><b>Library Name</b></th>
                            <th><b>Name</b></th>
                        </tr>
                        <tr>
                            
                                <td>Status</td>
                            
                            
                                <td>isEncounterPerformed</td>
                            
                        </tr>
                        <tr>
                            
                                <td></td>
                                <td>
                                    <pre class="highlight language-cql"><code class="language-cql">//Encounter, Performed
//General usage unless required otherwise by measure intent (e.g., follow-up encounters)
define fluent function isEncounterPerformed(Enc List&lt;Encounter&gt;):
  Enc E
    where E.status in {'finished', 'arrived', 'triaged', 'in-progress', 'onleave'}</code></pre>
                                </td>
                            
                        </tr>
                    
                        <tr>
                            <th><b>Library Name</b></th>
                            <th><b>Name</b></th>
                        </tr>
                        <tr>
                            
                                <td>QICoreCommon</td>
                            
                            
                                <td>toInterval</td>
                            
                        </tr>
                        <tr>
                            
                                <td></td>
                                <td>
                                    <pre class="highlight language-cql"><code class="language-cql">/*
@description: Normalizes a value that is a choice of timing-valued types to an equivalent interval
@comment: Normalizes a choice type of DateTime, Quanitty, Interval&lt;DateTime&gt;, or Interval&lt;Quantity&gt; types
to an equivalent interval. This selection of choice types is a superset of the majority of choice types that are used as possible
representations for timing-valued elements in QICore, allowing this function to be used across any resource.
The input can be provided as a DateTime, Quantity, Interval&lt;DateTime&gt; or Interval&lt;Quantity&gt;.
The intent of this function is to provide a clear and concise mechanism to treat single
elements that have multiple possible representations as intervals so that logic doesn't have to account
for the variability. More complex calculations (such as medication request period or dispense period
calculation) need specific guidance and consideration. That guidance may make use of this function, but
the focus of this function is on single element calculations where the semantics are unambiguous.
If the input is a DateTime, the result a DateTime Interval beginning and ending on that DateTime.
If the input is a Quantity, the quantity is expected to be a calendar-duration interpreted as an Age,
and the result is a DateTime Interval beginning on the Date the patient turned that age and ending immediately before one year later.
If the input is a DateTime Interval, the result is the input.
If the input is a Quantity Interval, the quantities are expected to be calendar-durations interpreted as an Age, and the result
is a DateTime Interval beginning on the date the patient turned the age given as the start of the quantity interval, and ending
immediately before one year later than the date the patient turned the age given as the end of the quantity interval.
If the input is a Timing, an error will be thrown indicating that Timing calculations are not implemented. Any other input will reslt in a null DateTime Interval
*/
define fluent function toInterval(choice Choice&lt;DateTime, Quantity, Interval&lt;DateTime&gt;, Interval&lt;Quantity&gt;, Timing&gt;):
  case
	  when choice is DateTime then
    	Interval[choice as DateTime, choice as DateTime]
		when choice is Interval&lt;DateTime&gt; then
  		choice as Interval&lt;DateTime&gt;
		when choice is Quantity then
		  Interval[Patient.birthDate + (choice as Quantity),
			  Patient.birthDate + (choice as Quantity) + 1 year)
		when choice is Interval&lt;Quantity&gt; then
		  Interval[Patient.birthDate + (choice.low as Quantity),
			  Patient.birthDate + (choice.high as Quantity) + 1 year)
		when choice is Timing then
      Message(null, true, 'NOT_IMPLEMENTED', 'Error', 'Calculation of an interval from a Timing value is not supported') as Interval&lt;DateTime&gt;
		else
			null as Interval&lt;DateTime&gt;
	end</code></pre>
                                </td>
                            
                        </tr>
                    
                        <tr>
                            <th><b>Library Name</b></th>
                            <th><b>Name</b></th>
                        </tr>
                        <tr>
                            
                                <td>CumulativeMedicationDuration</td>
                            
                            
                                <td>cumulativeDuration</td>
                            
                        </tr>
                        <tr>
                            
                                <td></td>
                                <td>
                                    <pre class="highlight language-cql"><code class="language-cql">/*
Now that we have functions for determining the medication period for individual
prescriptions, administrations, and dispenses, we can combine those using
an overall cumulative medication duration calculation.
There are two broad approaches to calculating cumulative duration, one that _collapses_
overlapping intervals so that calculations are not duplicated, and one that _rolls out_
overlapping intervals so that the durations are laid end-to-end.
First, we define a function that simply calculates CumulativeDuration of a set of
intervals:
*/
define fluent function cumulativeDuration(Intervals List&lt;Interval&lt;Date&gt;&gt;):
   if Intervals is not null then ( Sum((collapse Intervals per day)X
        return all(difference in days between start of X and 
          end of X
        )+ 1
    )
  ) 
    else null</code></pre>
                                </td>
                            
                        </tr>
                    
                        <tr>
                            <th><b>Library Name</b></th>
                            <th><b>Name</b></th>
                        </tr>
                        <tr>
                            
                                <td>Status</td>
                            
                            
                                <td>isAssessmentPerformed</td>
                            
                        </tr>
                        <tr>
                            
                                <td></td>
                                <td>
                                    <pre class="highlight language-cql"><code class="language-cql">//This library contains functions that are based on QDM 5.6 to QICore 4.1.1 March 2023 (https://github.com/cqframework/CQL-Formatting-and-Usage-Wiki/wiki/Authoring-Patterns---QICore-v4.1.1). The functions may appear similar to some QICoreCommon functions but different in that they have constraints that are relevant for measures authored by NCQA.

//Assessment, Performed
define fluent function isAssessmentPerformed(Obs List&lt;Observation&gt;):
  Obs O
    where O.status in { 'final', 'amended', 'corrected' }
          and exists ( O.category ObservationCategory
          where ( ObservationCategory ) ~ &quot;survey&quot;
      )</code></pre>
                                </td>
                            
                        </tr>
                    
                        <tr>
                            <th><b>Library Name</b></th>
                            <th><b>Name</b></th>
                        </tr>
                        <tr>
                            
                                <td>FHIRHelpers</td>
                            
                            
                                <td>ToConcept</td>
                            
                        </tr>
                        <tr>
                            
                                <td></td>
                                <td>
                                    <pre class="highlight language-cql"><code class="language-cql">/*
@description: Converts the given FHIR [CodeableConcept](https://hl7.org/fhir/datatypes.html#CodeableConcept) value to a CQL Concept.
*/
define function ToConcept(concept FHIR.CodeableConcept):
    if concept is null then
        null
    else
        System.Concept {
            codes: concept.coding C return ToCode(C),
            display: concept.text.value
        }</code></pre>
                                </td>
                            
                        </tr>
                    
                        <tr>
                            <th><b>Library Name</b></th>
                            <th><b>Name</b></th>
                        </tr>
                        <tr>
                            
                                <td>Status</td>
                            
                            
                                <td>isInterventionOrder</td>
                            
                        </tr>
                        <tr>
                            
                                <td></td>
                                <td>
                                    <pre class="highlight language-cql"><code class="language-cql">//Intervention, Order: active and completed only    
define fluent function isInterventionOrder(ServiceRequest List&lt;ServiceRequest&gt;):
  ServiceRequest S
    where S.status in { 'active', 'completed' }
      and S.intent = 'order'</code></pre>
                                </td>
                            
                        </tr>
                    
                        <tr>
                            <th><b>Library Name</b></th>
                            <th><b>Name</b></th>
                        </tr>
                        <tr>
                            
                                <td>Status</td>
                            
                            
                                <td>isInterventionPerformed</td>
                            
                        </tr>
                        <tr>
                            
                                <td></td>
                                <td>
                                    <pre class="highlight language-cql"><code class="language-cql">//Intervention, Performed
define fluent function isInterventionPerformed(Proc List&lt;Procedure&gt;):
  Proc P
    where P.status ~ 'completed'</code></pre>
                                </td>
                            
                        </tr>
                    
                        <tr>
                            <th><b>Library Name</b></th>
                            <th><b>Name</b></th>
                        </tr>
                        <tr>
                            
                                <td>Status</td>
                            
                            
                                <td>isMedicationActive</td>
                            
                        </tr>
                        <tr>
                            
                                <td></td>
                                <td>
                                    <pre class="highlight language-cql"><code class="language-cql">//Medication, Active
define fluent function isMedicationActive(MedicationRequest List&lt;MedicationRequest&gt;):
  MedicationRequest M
    where M.status = 'active'
      and M.intent = 'order'</code></pre>
                                </td>
                            
                        </tr>
                    
                        <tr>
                            <th><b>Library Name</b></th>
                            <th><b>Name</b></th>
                        </tr>
                        <tr>
                            
                                <td>CQMCommon</td>
                            
                            
                                <td>ToDateInterval</td>
                            
                        </tr>
                        <tr>
                            
                                <td></td>
                                <td>
                                    <pre class="highlight language-cql"><code class="language-cql">/*
@description: Returns an interval of date values extracted from the input interval of date-time values
@comment: This function returns an interval constructed using the `date from` extractor on the start
and end values of the input date-time interval. Note that using a precision specifier such as `day of`
as part of a timing phrase is preferred to communicate intent to perform day-level comparison, as well
as for general readability.
*/
define function &quot;ToDateInterval&quot;(period Interval&lt;DateTime&gt;):
  Interval[date from start of period, date from end of period]</code></pre>
                                </td>
                            
                        </tr>
                    
                        <tr>
                            <th><b>Library Name</b></th>
                            <th><b>Name</b></th>
                        </tr>
                        <tr>
                            
                                <td>CumulativeMedicationDuration</td>
                            
                            
                                <td>medicationRequestPeriod</td>
                            
                        </tr>
                        <tr>
                            
                                <td></td>
                                <td>
                                    <pre class="highlight language-cql"><code class="language-cql">define fluent function medicationRequestPeriod(Request &quot;MedicationRequest&quot;):
  Request R
    let
      dosage: singleton from R.dosageInstruction,
      doseAndRate: singleton from dosage.doseAndRate,
      timing: dosage.timing,
      frequency: Coalesce(timing.repeat.frequencyMax, timing.repeat.frequency),
      period: Quantity(timing.repeat.period, timing.repeat.periodUnit),
      doseRange: doseAndRate.dose,
      doseQuantity: doseAndRate.dose,
      dose: Coalesce(end of doseRange, doseQuantity),
      dosesPerDay: Coalesce(ToDaily(frequency, period), Count(timing.repeat.timeOfDay), 1.0),
      boundsPeriod: timing.repeat.bounds as Interval&lt;DateTime&gt;,
      daysSupply: (convert R.dispenseRequest.expectedSupplyDuration to days).value,
      quantity: R.dispenseRequest.quantity,
      refills: Coalesce(R.dispenseRequest.numberOfRepeatsAllowed, 0),
      startDate:
        Coalesce(
          date from start of boundsPeriod,
          date from R.authoredOn,
          date from start of R.dispenseRequest.validityPeriod
        ),
      totalDaysSupplied: Coalesce(daysSupply, quantity.value / (dose.value * dosesPerDay)) * (1 + refills)
    return
      if startDate is not null and totalDaysSupplied is not null then
        Interval[startDate, startDate + Quantity(totalDaysSupplied - 1, 'day') ]
      else if startDate is not null and boundsPeriod.&quot;high&quot; is not null then
        Interval[startDate, date from end of boundsPeriod]
      else
        null</code></pre>
                                </td>
                            
                        </tr>
                    
                    </table>
                </td>
            </tr>
            
        
    

    </table>
</div>
</body>
</html>